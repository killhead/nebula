# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ Railway Deployment

## üö® –ü—Ä–æ–±–ª–µ–º–∞

Railway healthcheck –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ:
1. **GraphD –Ω–µ –º–æ–∂–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –±–µ–∑ MetaD –∏ StorageD**
2. **–í Railway —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä**
3. **Healthcheck –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `/status` –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—Å—Ç—è—Ç—Å—è**

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π Dockerfile

–¢–µ–ø–µ—Ä—å Dockerfile:
- **–ö–æ–ø–∏—Ä—É–µ—Ç –≤—Å–µ –±–∏–Ω–∞—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã** (MetaD, StorageD, GraphD) –≤ –æ–¥–∏–Ω –æ–±—Ä–∞–∑
- **–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç curl** –¥–ª—è healthcheck
- **–ó–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã** —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç `start.sh`

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞

`scripts/start.sh` —Ç–µ–ø–µ—Ä—å:
- **–ó–∞–ø—É—Å–∫–∞–µ—Ç MetaD –ø–µ—Ä–≤—ã–º** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤)
- **–ñ–¥–µ—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ MetaD** (10 —Å–µ–∫—É–Ω–¥)
- **–ó–∞–ø—É—Å–∫–∞–µ—Ç StorageD** –∏ –∂–¥–µ—Ç –µ–≥–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
- **–ó–∞–ø—É—Å–∫–∞–µ—Ç GraphD** –∏ –∂–¥–µ—Ç –µ–≥–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã** –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–∏ —Å–±–æ—è—Ö

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–í—Å–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã –¥–ª—è **standalone —Ä–µ–∂–∏–º–∞**:
- **MetaD**: `local_ip=127.0.0.1` (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π)
- **StorageD**: `local_ip=127.0.0.1` (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π)  
- **GraphD**: `local_ip=0.0.0.0` (–≤–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø)

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π healthcheck

- **–£–≤–µ–ª–∏—á–µ–Ω start-period** –¥–æ 120 —Å–µ–∫—É–Ω–¥
- **–£–≤–µ–ª–∏—á–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ retries** –¥–æ 5
- **–£–≤–µ–ª–∏—á–µ–Ω timeout** –≤ railway.json –¥–æ 200 —Å–µ–∫—É–Ω–¥

## üöÄ –ö–∞–∫ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ó–∞—Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

```bash
cd /home/dmitry/projects/texts/cases/profiler/nebula
git add .
git commit -m "Fix Railway deployment: standalone mode with all services"
git push origin main
```

### 2. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–µ—Ç

Railway –æ–±–Ω–∞—Ä—É–∂–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏:
- –ü–µ—Ä–µ—Å–æ–±–µ—Ä–µ—Ç Docker –æ–±—Ä–∞–∑
- –†–∞–∑–≤–µ—Ä–Ω–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é
- –ó–∞–ø—É—Å—Ç–∏—Ç healthcheck —Å –Ω–æ–≤—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

### 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

–°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏ –≤ Railway Dashboard:
- **–°–±–æ—Ä–∫–∞**: –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–π—Ç–∏ —É—Å–ø–µ—à–Ω–æ
- **–ó–∞–ø—É—Å–∫**: –≤—Å–µ —Ç—Ä–∏ —Å–µ—Ä–≤–∏—Å–∞ –¥–æ–ª–∂–Ω—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è
- **Healthcheck**: –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–π—Ç–∏ —á–µ—Ä–µ–∑ 2-3 –º–∏–Ω—É—Ç—ã

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:

```
Starting NebulaGraph on Railway...
Starting metad...
metad started with PID 123
Waiting for MetaD to be ready...
Starting storaged...
storaged started with PID 124
Waiting for StorageD to be ready...
Starting graphd...
graphd started with PID 125
Waiting for GraphD to be ready...
Checking service status...
metad is running (PID: 123)
storaged is running (PID: 124)
graphd is running (PID: 125)
All NebulaGraph services started successfully!
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å:**
   ```bash
   curl https://your-app-url.up.railway.app:19669/status
   ```

2. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å —á–µ—Ä–µ–∑ CLI:**
   ```bash
   docker run -it --rm vesoft/nebula-console:latest \
     --addr=your-app-url.up.railway.app --port=9669 \
     --user=root --password=nebula
   ```

3. **–í—ã–ø–æ–ª–Ω–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã:**
   ```cypher
   SHOW HOSTS;
   SHOW SPACES;
   ```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞**: –ü–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫ –∑–∞–Ω–∏–º–∞–µ—Ç 2-3 –º–∏–Ω—É—Ç—ã
2. **–†–µ—Å—É—Ä—Å—ã**: –í—Å–µ —Ç—Ä–∏ —Å–µ—Ä–≤–∏—Å–∞ –≤ –æ–¥–Ω–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ —Ç—Ä–µ–±—É—é—Ç –±–æ–ª—å—à–µ —Ä–µ—Å—É—Ä—Å–æ–≤
3. **–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**: –î–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø–æ—Ç–µ—Ä—è–Ω—ã –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ Railway
4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –î–ª—è production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

## üÜò –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã –æ—Å—Ç–∞—é—Ç—Å—è

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Railway** –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
2. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã** –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è** –≤ Railway
4. **–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ** —Å `docker-compose up`

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç—Å—è:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ [Railway Documentation](https://docs.railway.app/)
- –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ [NebulaGraph Community](https://github.com/vesoft-inc/nebula)
- –°–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
